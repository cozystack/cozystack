apiVersion: cozystack.io/v1alpha1
kind: ApplicationDefinition
metadata:
  name: vm-import
spec:
  application:
    kind: VMImport
    singular: vmimport
    plural: vmimports
    openAPISchema: |-
      {"title":"Chart Values","type":"object","properties":{"enableAdoption":{"description":"Automatically label imported VMs for Cozystack adoption and dashboard visibility.","type":"boolean","default":true},"networkMap":{"description":"Mapping of source networks to destination networks.","type":"array","default":[],"items":{"type":"object","required":["destinationType","sourceId"],"properties":{"destinationName":{"description":"Name of the destination network (required if type is `multus`).","type":"string"},"destinationNamespace":{"description":"Namespace of the destination network.","type":"string"},"destinationType":{"description":"Destination type: `pod` for pod network, or `multus` for a Multus network.","type":"string"},"sourceId":{"description":"The managed object reference ID of the source network in vSphere.","type":"string"}}}},"sourceSecretName":{"description":"Name of the Kubernetes Secret containing VMware credentials (`user`, `password`, `thumbprint` keys).","type":"string","default":""},"sourceUrl":{"description":"URL of the VMware vCenter server (e.g. `https://vcenter.example.com/sdk`).","type":"string","default":""},"storageMap":{"description":"Mapping of source datastores to destination StorageClasses.","type":"array","default":[],"items":{"type":"object","required":["sourceId","storageClass"],"properties":{"sourceId":{"description":"The managed object reference ID of the source datastore in vSphere.","type":"string"},"storageClass":{"description":"Name of the destination Kubernetes StorageClass.","type":"string"}}}},"vms":{"description":"List of virtual machines to migrate.","type":"array","default":[],"items":{"type":"object","required":["id"],"properties":{"id":{"description":"The managed object reference ID of the VM in vSphere (e.g. `vm-123`).","type":"string"},"name":{"description":"Optional target name for the VM in KubeVirt.","type":"string"}}}},"warm":{"description":"Enable warm migration (incremental replication before cutover).","type":"boolean","default":false}}}
  release:
    prefix: vm-import-
    labels:
      sharding.fluxcd.io/key: tenants
    chartRef:
      kind: ExternalArtifact
      name: cozystack-vm-import-application-kubevirt-vm-import
      namespace: cozy-system
  dashboard:
    category: IaaS
    singular: VM Import
    plural: VM Imports
    description: Import virtual machines from VMware vSphere
    weight: 55
    tags:
      - migration
      - vmware
    icon: PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNDQiIGhlaWdodD0iMTQ0IiByeD0iMjQiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcikiLz4KPHBhdGggZD0iTTcyIDM2QzU0LjMyNyAzNiA0MCA1MC4zMjcgNDAgNjhDNDAgODUuNjczIDU0LjMyNyAxMDAgNzIgMTAwQzg5LjY3MyAxMDAgMTA0IDg1LjY3MyAxMDQgNjhDMTA0IDUwLjMyNyA4OS42NzMgMzYgNzIgMzZaTTcyIDkyQzU4Ljc0NSA5MiA0OCA4MS4yNTUgNDggNjhDNDggNTQuNzQ1IDU4Ljc0NSA0NCA3MiA0NEM4NS4yNTUgNDQgOTYgNTQuNzQ1IDk2IDY4Qzk2IDgxLjI1NSA4NS4yNTUgOTIgNzIgOTJaIiBmaWxsPSIjQkFEOUZGIi8+CjxwYXRoIGQ9Ik03MiA1Nkw1OCA2OEg2NlY4MEg3OFY2OEg4Nkw3MiA1NloiIGZpbGw9IiMwMEI0RkYiLz4KPHBhdGggZD0iTTQyIDEwOEwzNCAxMTZINTRMNDYgMTA4SDQyWiIgZmlsbD0iI0NERTNGRiIvPgo8cGF0aCBkPSJNOTggMTA4TDkwIDExNkgxMTBMMTAyIDEwOEg5OFoiIGZpbGw9IiNDREUzRkYiLz4KPHBhdGggZD0iTTcwIDEwOEw2MiAxMTZIODJMNzQgMTA4SDcwWiIgZmlsbD0iI0NERTNGRiIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyIiB4MT0iLTE1LjUiIHkxPSItMTIiIHgyPSIyMTYuNSIgeTI9IjE4NS41IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiM2NUNDRkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDQ0Mzc0Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==
    keysOrder: [["apiVersion"], ["appVersion"], ["kind"], ["metadata"], ["metadata", "name"], ["spec", "sourceUrl"], ["spec", "sourceSecretName"], ["spec", "vms"], ["spec", "warm"], ["spec", "enableAdoption"], ["spec", "networkMap"], ["spec", "storageMap"]]
