
apiVersion: cozystack.io/v1alpha1
kind: PackageSource
metadata:
  name: cozystack.monitoring
  annotations:
    operator.cozystack.io/skip-cozystack-values: "true"
spec:
  sourceRef:
    kind: OCIRepository
    name: cozystack-packages
    namespace: cozy-system
    path: /
  variants:
    - name: default
      dependsOn:
        - cozystack.cozystack-controller
        - cozystack.vertical-pod-autoscaler
        - cozystack.networking
        - cozystack.postgres-operator
        - cozystack.grafana-operator
        - cozystack.victoria-metrics-operator
        - cozystack.prometheus-operator-crds
      libraries:
        - name: cozy-lib
          path: library/cozy-lib
      components:
        - name: monitoring
          path: system/monitoring
          libraries: ["cozy-lib"]
          install:
            privileged: true
            namespace: cozy-monitoring
            releaseName: monitoring
        - name: vertical-pod-autoscaler
          path: system/vertical-pod-autoscaler
          install:
            namespace: cozy-vertical-pod-autoscaler
            releaseName: vertical-pod-autoscaler
        - name: postgres-operator
          path: system/postgres-operator
          install:
            namespace: cozy-postgres-operator
            releaseName: postgres-operator
        - name: grafana-operator
          path: system/grafana-operator
          install:
            namespace: cozy-grafana-operator
            releaseName: grafana-operator
        - name: victoria-metrics-operator
          path: system/victoria-metrics-operator
          install:
            namespace: cozy-victoria-metrics-operator
            releaseName: victoria-metrics-operator
        - name: prometheus-operator-crds
          path: system/prometheus-operator-crds
          install:
            namespace: cozy-prometheus-operator-crds
            releaseName: prometheus-operator-crds