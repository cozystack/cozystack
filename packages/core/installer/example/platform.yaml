---
apiVersion: source.toolkit.fluxcd.io/v1
kind: GitRepository
metadata:
  name: cozystack
  namespace: cozy-system
spec:
  interval: 1m0s
  ref:
    branch: refactor-engine
  timeout: 60s
  url: https://github.com/cozystack/cozystack.git
---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: cozystack-platform
  namespace: cozy-system
spec:
  interval: 5m
  targetNamespace: cozy-system
  releaseName: cozystack-platform
  chart:
    spec:
      chart: ./packages/core/platform
      sourceRef:
        kind: GitRepository
        name: cozystack
        namespace: cozy-system
  values:
    sourceRef:
      kind: GitRepository
      name: cozystack
      namespace: cozy-system
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: cozystack
  namespace: cozy-system
data:
  bundle-name: "paas-full"
  root-host: "example.org"
  api-server-endpoint: "https://api.example.org:443"
  expose-services: "dashboard,api"
  ipv4-pod-cidr: "10.244.0.0/16"
  ipv4-pod-gateway: "10.244.0.1"
  ipv4-svc-cidr: "10.96.0.0/16"
  ipv4-join-cidr: "100.64.0.0/16"
